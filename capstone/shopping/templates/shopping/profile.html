{% extends "shopping/layout.html" %}
{% load static %}

{% block style %}
    <link href="{% static 'shopping/profile/profile.css' %}" rel="stylesheet">
{% endblock %}

{% block script %}
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js" integrity="sha384-B4gt1jrGC7Jh4AgTPSdUtOBvfO8shuf57BaghqFfPlYxofvL8/KUEfYiJOMMV+rV" crossorigin="anonymous"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.5.1/jquery.min.js"></script>
    <script src="{% static 'shopping/profile/profile.js' %}"></script>
    <script type="text/javascript">
        function createNewListingNotification() {
            alert('You have created a new listing.');
        }
    </script>
{% endblock %}

{% block content %}
        <!-- Profile section -->
        <div class="container-fluid" style="margin-top: 15px; min-height: 800px;">
            <div class="row">
                <div class="col-4">
                    <div class="row mt-2" style="justify-content: center;">
                        <div class="image-border">
                            {% if profile.profile_pic.url is not None %}
                                <img class="profile-pic" src="{% static profile.profile_pic.url %}" alt="user-profile-pic">
                            {% else %}
                                <img class="profile-pic" src="{% static 'images/placeholder.png' %}" alt="placeholder-profile-pic">
                            {% endif %}
                            <span style="margin-left: 5px;">{{ user.username }}
                                <button id="edit-profile-btn">
                                    <i class="fa fa-edit"></i>
                                    Edit profile
                                </button>
                            </span>
                        </div>
                    </div>

                    <hr>

                    <div class="row mt-4 ml-1 mb-4">
                        <button id="my-account-btn" class="user-profile-links">
                            <i class="fa fa-user-circle" style="font-size: 16px; width: 30px; color: #42f5c2;"></i>
                            <span class="user-links">My Account Info</span>
                        </button>
                        <div class="w-100 d-none d-md-block"></div>
                        <button id="my-purchase-btn" class="user-profile-links" id="my-purchase">
                            <i class="fa fa-shopping-cart" style="font-size: 15px; width: 30px; color: lightblue;"></i>
                            <span class="user-links">My Purchase</span>
                        </button>
                        <div class="w-100 d-none d-md-block"></div>
                        <button id="my-shop-btn" class="user-profile-links">
                            <i class="fa fa-shopping-bag" style="font-size: 15px; width: 30px; color: red;"></i>
                            <span class="user-links">My Shop</span>
                        </button>
                        <div class="w-100 d-none d-md-block"></div>
                        <button id="notif-btn" class="user-profile-links">
                            <i class="fa fa-bell" style="font-size: 16px; width: 30px; color: orange;"></i>
                            <span class="user-links">Notifications</span>
                        </button>
                    </div>

                    <hr>

                    <!-- Add profile picture section -->
                    <div class="row mt-4 ml-1 mb-4" style="justify-content: center;">
                        <img id="output" style="height: 100px; width: 100px; border-radius: 50px;" src="https://user-images.githubusercontent.com/59989652/88834961-2aa0b280-d207-11ea-9e3d-24c488a75569.jpg" alt="Profile Picture">
                    </div>
                    <div class="row mt-4 ml-1 mb-4" style="justify-content: center; text-align: center;">
                        <form class="custom-file" id="profile-pic-form" action="{% url 'update_profile_pic' %}" method="post" enctype="multipart/form-data">
                            {% csrf_token %}
                            <div class="" style="text-align: center; justify-content: center;">
                                <input id="file-upload" class="custom-file-input" type="file" name="myfile" accept=".jpg,.jpeg,.png" onchange="loadFile(event)">
                                <input style="display: none;" type="submit" id="profile-pic-btn" class="profile-pic-btn" value="Save">
                                <label id="image-file-label" class="custom-file-label" for="file-upload">Image extensions: .JPEG .PNG</label>
                            </div>
                        </form>
                    </div>
                    <div class="row mt-4 ml-1 mb-4 mt-4" style="justify-content: center;">
                        <p style="color: grey;"></p>
                    </div>
                </div>
                <div id="user-profile-content" class="col-8 mt-3 mb-3">
                    <div id="my-account">
                        <h4>My Account Information</h4>

                        <div class="container-fluid bg-light mt-4 pt-5 pl-5 pb-5">
                            <div class="row">
                                <p class="account-tags">Username:</p>
                                <span id="span-username">{{ user.username }}</span>
                            </div>
                            <div class="row">
                                <p class="account-tags">Name:</p>
                                <span id="span-full-name">{{ profile.full_name }}</span>
                            </div>
                            <div class="row">
                                <p class="account-tags">Email:</p>
                                <span id="span-email">{{ user.email }}</span>
                            </div>
                            <div class="row">
                                <p class="account-tags">Gender:</p>
                                <span id="span-gender">{{ profile.gender }} </span>
                            </div>
                            <div class="row">
                                <p class="account-tags">Phone Number:</p>
                                <span id="span-phone-number">{{ hexed_phone_number }}</span>
                            </div>
                            <div class="row">
                                <p class="account-tags">Date of Birth:</p>
                                <span id="span-date-of-birth">{{ profile.date_of_birth }}</span>
                            </div>
                        </div>
                    </div>

                    <!-- My Shop -->
                    <div id="my-shop">
                        <div class="row">
                            <div class="col-6">
                                <h4>My Shop</h4>
                            </div>
                            <div class="col-6 text-right">
                                <button class="btn" id="add-listing-btn" type="button" name="button" data-toggle="modal" data-target="#listingModal">Add New Listing</button>
                                <!-- Create Listing Modal -->
                                <div class="modal fade" id="listingModal" tabindex="-1" role="dialog">
                                    <div class="modal-dialog modal-lg" role="document">
                                        <div class="modal-content">
                                            <div class="modal-header">
                                                <h5 class="modal-title">Create New Listing</h5>
                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                    <span aria-hidden="true">&times;</span>
                                                </button>
                                            </div>
                                            <div class="modal-body">
                                                <form onsubmit="createNewListingNotification()" id="add-listing-form" class="" action="{% url 'create_listing' %}" method="post" enctype="multipart/form-data">
                                                    {% csrf_token %}
                                                    <div class="form-group row pt-3 pb-3">
                                                        <label for="id_title" class="col-sm-3 col-form-label">Title:</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" class="form-control" id="id_title" name="title" required>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="id_description" class="col-sm-3 col-form-label">Description:</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" required class="form-control" id="id_description" name="desrc" value="">
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="id_price" class="col-sm-3 col-form-label">Selling Price: (in dollars)</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" required class="form-control" id="id_price" name="price" value="" placeholder="Input format: 00.00">
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="id_quantity" class="col-sm-3 col-form-label">Quantity available</label>
                                                        <div class="col-sm-9">
                                                            <input type="text" required class="form-control" id="id_quantity" name="quantity" value="" placeholder="Stock available for sale">
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="id_gender" class="col-sm-3 col-form-label">Category:</label>
                                                        <div class="col-sm-9">
                                                            <select class="form-control" name="category" id="id_category" required>
                                                                <option value="Men's Wear">Men's Wear</option>
                                                                <option value="Women's Apparel">Women's Apparel</option>
                                                                <option value="Mobile & Gadgets">Mobile & Gadgets</option>
                                                                <option value="Beauty & Personal Care">Beauty & Personal Care</option>
                                                                <option value="Home Appliances">Home Appliances</option>
                                                                <option value="Home & Living">Home & Living</option>
                                                                <option value="Kids Fashion">Kids Fashion</option>
                                                                <option value="Toys, Kids & Babies">Toys, Kids & Babies</option>
                                                                <option value="Video Games">Video Games</option>
                                                                <option value="Food & Beverages">Food & Beverages</option>
                                                                <option value="Computer & Peripherals">Computer & Peripherals</option>
                                                                <option value="Hobbies & Books">Hobbies & Books</option>
                                                                <option value="Health & Wellness">Health & Wellness</option>
                                                                <option value="Women's Bags">Women's Bags</option>
                                                                <option value="Travel & Luggage">Travel & Luggage</option>
                                                                <option value="Pet Food & Supplies">Pet Food & Supplies</option>
                                                                <option value="Watches">Watches</option>
                                                                <option value="Jewellery & Accessory">Jewellery & Accessory</option>
                                                                <option value="Men's Shoes">Men's Shoes</option>
                                                                <option value="Women's Shoes">Women's Shoes</option>
                                                                <option value="Sports & Outdoors">Sports & Outdoors</option>
                                                                <option value="Automotive">Automotive</option>
                                                                <option value="Men's Bags">Men's Bags</option>
                                                                <option value="Cameras & Drones">Cameras & Drones</option>
                                                                <option value="Dining, Travel & Services">Dining, Travel & Services</option>
                                                                <option value="Miscellaneous">Miscellaneous</option>
                                                            </select>
                                                        </div>
                                                    </div>
                                                    <div class="form-group row">
                                                        <label for="id_images" class="col-sm-3 col-form-label">Images</label>
                                                        <div class="col-sm-9">
                                                            <div class="custom-file" style="text-align: left;">
                                                                <input type="file" name="image_files" accept=".jpg,.jpeg,.png" multiple required class="custom-file-input" id="id_images" value="">
                                                                <label class="custom-file-label" for="customFile">You may upload multiple images.</label>
                                                            </div>

                                                        </div>
                                                    </div>
                                                    <div class="modal-footer">
                                                        <button type="button" id="" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                        <button type="submit" id="create-listing-btn" class="btn">Create</button>
                                                    </div>
                                                </form>
                                            </div>
                                        </div>
                                    </div>
                                </div>
                            </div>
                        </div>

                        <hr>
                        <!-- Listing Nav Bar -->
                        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                            <li class="nav-item pill-1">
                                <a class="nav-link active" id="pills-listing-tab" data-toggle="pill" href="#pills-listing" role="tab" aria-controls="pills-listing" aria-selected="true">My Listings</a>
                            </li>
                            <li class="nav-item pill-1">
                                <a class="nav-link" id="pills-sold-tab" data-toggle="pill" href="#pills-sold" role="tab" aria-controls="pills-sold" aria-selected="false">Items Sold</a>
                            </li>
                            <li class="nav-item pill-1">
                                <a class="nav-link" id="pills-review-tab" data-toggle="pill" href="#pills-review" role="tab" aria-controls="pills-review" aria-selected="false">Customers' Reviews</a>
                            </li>
                        </ul>
                        <div class="tab-content" id="pills-tabContent">
                            <div class="tab-pane fade show active" id="pills-listing" role="tabpanel" aria-labelledby="pills-listing-tab">
                                {% if has_listings %}
                                    {% for listing in listing_page_obj %}
                                        <div id="indv-listing-{{ listing.id }}" class="container p-3 my-3">
                                            <div class="row">
                                                <div class="col-4 p-3 listing-image-section">
                                                    {% if listing.images is None %}
                                                        <img class="listing-images" src="{% static 'shopping/categories/listing_placeholder.jpg' %}" alt="listing-placeholder-image">
                                                    {% else %}
                                                        <img class="listing-images" src="{% static listing.listing_main_pic.url %}" alt="listing-image">
                                                    {% endif %}
                                                </div>
                                                <div class="col-8 p-3">
                                                    <a class="cart-item-details" href="{% url 'listing' listing.id %}">{{ listing.title }}</a>
                                                    <p class="cart-item-details" style="color: grey;">Category: <strong>{{ listing.category }}</strong></p>
                                                    <p class="cart-item-details" style="margin-bottom: 4px;"><strong>Product Description:</strong></p>
                                                    <p class="listing-desrc cart-item-details" style="color: grey;">{{ listing.desrc }}</p>
                                                    <div class="row">
                                                        <div class="col-6" style="text-align: left;">
                                                            <p class="cart-item-details">Quantity left: <strong>{{ listing.quantity }}</strong></p>
                                                        </div>
                                                        <div class="col-6" style="text-align: right;">
                                                            <p class="cart-item-details">Price: <strong>${{ listing.price }}</strong></p>
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        </div>
                                        <hr>
                                    {% endfor %}

                                    <div class="row justify-content-center">
                                        <!-- My listing paginator -->
                                        <nav aria-label="Page navigation listings">
                                            <ul class="pagination justify-content-center">
                                                {% if listing_page_obj.has_previous %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?listing-page=1">&laquo; first</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?listing-page={{ listing_page_obj.previous_page_number }}">previous</a>
                                                    </li>
                                                {% endif %}

                                                {% if listing_page_obj.number != 1 %}
                                                    <span class="current">
                                                        <p style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">
                                                            Page {{ listing_page_obj.number }} of {{ listing_page_obj.paginator.num_pages }}.
                                                        </p>
                                                    </span>
                                                {% endif %}

                                                {% if listing_page_obj.has_next %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?listing-page={{ listing_page_obj.next_page_number }}">next</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?listing-page={{ listing_page_obj.paginator.num_pages }}">last &raquo;</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </nav>
                                    </div>
                                {% else %}
                                    <p>You have no listings in the market currently.</p>
                                {% endif %}
                            </div>
                            <div class="tab-pane fade" id="pills-sold" role="tabpanel" aria-labelledby="pills-sold-tab">
                                {% if has_item_sold %}
                                    {% for order in order_page_obj %}
                                        {% if order.has_purchased is True %}
                                            <div id="indv-listing-{{ order.listing.id }}" class="container p-3 my-3">
                                                <div class="row">
                                                    <div class="col-4 p-3 listing-image-section" style="text-align: center; justify-content;">
                                                        {% if order.listing.images is None %}
                                                            <img class="listing-images" src="{% static 'shopping/categories/listing_placeholder.jpg' %}" alt="listing-placeholder-image">
                                                        {% else %}
                                                            <img class="listing-images" src="{% static order.listing.listing_main_pic.url %}" alt="listing-image">
                                                        {% endif %}
                                                    </div>
                                                    <div class="col-8">
                                                        <a class="cart-item-details" href="{% url 'listing' order.listing.id %}">{{ order.listing.title }}</a>
                                                        <p class="cart-item-details" style="color: grey;">Category: <strong>{{ order.listing.category }}</strong></p>
                                                        <p class="cart-item-details" style="margin-bottom: 4px;"><strong>Product Description:</strong></p>
                                                        <p class="listing-desrc cart-item-details" style="color: grey;">{{ order.listing.desrc }}</p>
                                                        <div class="row">
                                                            <div class="col-6" style="text-align: left;">
                                                                <p class="cart-item-details">Quantity sold: <strong>{{ order.quantity_demanded }}</strong></p>
                                                            </div>
                                                            <div class="col-6" style="text-align: right;">
                                                                <p class="cart-item-details">Price: <strong>${{ order.listing.price }}</strong></p>
                                                            </div>
                                                        </div>
                                                        <p class="cart-item-details">Ordered by: <a href="{% url 'profile' order.user.username %}">{{ order.user }}</a></p>
                                                        <div class="row">
                                                            <div class="col-6">
                                                                <p class="cart-item-details" id="order-status-{{ order.id }}">Order Status: <strong>{{ order.status }}</strong></p>
                                                            </div>
                                                            {% if order.status != "Completed" %}
                                                                <hr>
                                                                <div class="col-6" style="text-align: right">
                                                                    <select id="select-order-status-{{ order.id }}" class="cart-item-details"" name="">
                                                                        <option class="cart-item-details" value="To Ship">To Ship</option>
                                                                        <option class="cart-item-details" value="To Receive">To Receive</option>
                                                                        <option class="cart-item-details" value="Completed">Completed</option>
                                                                        <option class="cart-item-details" value="Cancelled">Cancelled</option>
                                                                        <option class="cart-item-details" value="Return">Return</option>
                                                                    </select>
                                                                    <input type="button" id="update-order-status-{{ order.id }}" class="update-order-status-btn" name="update-order-status-btn" value="Update Order Status">
                                                                </div>
                                                            {% endif %}
                                                        </div>
                                                    </div>
                                                </div>
                                            </div>
                                        {% endif %}
                                        <hr>
                                    {% endfor %}
                                    <div class="row justify-content-center">
                                        <nav aria-label="My purchases pagination">
                                            <ul class="pagination justify-content-center">
                                                {% if order_page_obj.has_previous %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?order-page=1">&laquo; first</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?order-page={{ order_page_obj.previous_page_number }}">previous</a>
                                                    </li>
                                                {% endif %}

                                                {% if order_page_obj.number != 1%}
                                                    <span class="current">
                                                        <p style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">
                                                            Page {{ order_page_obj.number }} of {{ order_page_obj.paginator.num_pages }}.
                                                        </p>
                                                    </span>
                                                {% endif %}

                                                {% if order_page_obj.has_next %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?order-page={{ order_page_obj.next_page_number }}">next</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?order-page={{ order_page_obj.paginator.num_pages }}">last &raquo;</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </nav>
                                    </div>
                                {% else %}
                                    <p>You have no items sold in the market currently.</p>
                                {% endif %}
                            </div>
                            <div class="tab-pane fade" id="pills-review" role="tabpanel" aria-labelledby="pills-review-tab">
                                {% if has_reviews %}
                                    {% for review in review_page_obj %}
                                        {% if review.user != user %}
                                            <div class="row">
                                                <div class="col-2" style="text-align: center; max-width: 45px;">
                                                    <div class="image-border" style="text-align: center;">
                                                        {% if review.profile.profile_pic.url is not None %}
                                                            <img class="profile-pic" src="{% static review.profile.profile_pic.url %}" alt="user-profile-pic">
                                                        {% else %}
                                                            <img class="profile-pic" src="{% static 'images/placeholder.png' %}" alt="placeholder-profile-pic">
                                                        {% endif %}
                                                    </div>
                                                </div>
                                                <div class="col-10">
                                                    <div class="row">
                                                        <div class="col-6">
                                                            <a style="padding-top: 1rem;" href="{% url 'profile' review.user.username %}">{{ review.user.username }}</a>
                                                        </div>
                                                    </div>

                                                    <!-- Rating stars -->
                                                    <p style="font-size: 13px; color:grey;">{{ review.date }}</p>
                                                    <div id="{{ review.id }}" class="rating-stars cart-item-details" data-ratingvalue="{{ review.rating }}"></div>
                                                    <p class="cart-item-details">{{ review.review }}</p>
                                                    <span style="color: grey; font-style: italic;" class="cart-item-details">
                                                        For listing: <a style="font-style: normal;" href="{% url 'listing' review.listing.id %}">{{ listing.title }}</a>
                                                    </span>
                                                    <p class="cart-item-details">{{ review.datetime }}</p>
                                                </div>
                                            </div>
                                            <hr>
                                        {% endif %}
                                    {% endfor %}

                                    <div class="row justify-content-center">
                                        <!-- My Review paginator -->
                                        <nav aria-label="Page navigation listings">
                                            <ul class="pagination justify-content-center">
                                                {% if review_page_obj.has_previous %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?review-page=1">&laquo; first</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?review-page={{ review_page_obj.previous_page_number }}">previous</a>
                                                    </li>
                                                {% endif %}

                                                {% if review_page_obj.number != 1 %}
                                                    <span class="current">
                                                        <p style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">
                                                            Page {{ review_page_obj.number }} of {{ review_page_obj.paginator.num_pages }}.
                                                        </p>
                                                    </span>
                                                {% endif %}

                                                {% if review_page_obj.has_next %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?review-page={{ review_page_obj.next_page_number }}">next</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?review-page={{ review_page_obj.paginator.num_pages }}">last &raquo;</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </nav>
                                    </div>
                                {% else %}
                                    <p>You have no customers' reviews currently.</p>
                                {% endif %}
                            </div>
                        </div>
                    </div>

                    <div id="my-purchase">
                        <h4>My Purchase</h4>
                        <hr>
                        {% if has_purchases %}
                            {% for order in order_page_obj %}
                                <div class="container indv-purchase-border">
                                    <div class="row m-3 p-1">
                                        <div class="col-4 p-3" style="text-align: left; justify-content: center;">
                                            {% if order.listing.images is None %}
                                                <img style="height: auto; width: 100%;" class="listing-images" src="{% static 'shopping/categories/listing_placeholder.jpg' %}" alt="listing-placeholder-image">
                                            {% else %}
                                                <img style="height: auto; width: 100%;" class="listing-images" src="{% static order.listing.listing_main_pic.url %}" alt="listing-image">
                                            {% endif %}
                                        </div>
                                        <div class="col-6 p-3">
                                            <a class="cart-item-details" href="{% url 'listing' order.listing.id %}">{{ order.listing.title }}</a>
                                            <p class="cart-item-details" style="color: grey;">Category: <strong>{{ order.listing.category }}</strong></p>
                                            <p class="cart-item-details" style="margin-bottom: 4px;"><strong>Product Description:</strong></p>
                                            <p class="cart-item-details listing-desrc" style="color: grey;">{{ order.listing.desrc }}</p>
                                            <p class="cart-item-details">Quantity Bought: <strong>{{ order.quantity_demanded }}</strong></p>
                                        </div>
                                        <div class="col-2 my-auto" style="text-align: center;">
                                            <div class="" style="text-align: center;">
                                                <p class="cart-item-details order-status" style="">{{ order.status }}</p>
                                            </div>

                                            {% if order.status == "To Ship" or order.status == "To Receive" or order.status == "Completed" %}
                                                <form class="" action="{% url 'return_order' %}" method="GET">
                                                    {% csrf_token %}
                                                    <input type="text" style="display: none;" name="return_order_id" value="{{ order.id }}">
                                                    <button type="button" data-toggle="modal" data-target="#return-order-modal" class="return-btn" id="return-btn" name="button">Return</button>

                                                    <!-- Return Order Notification Modal -->
                                                    <div class="modal fade" id="return-order-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <div class="modal-dialog" role="document">
                                                        <div class="modal-content">
                                                            <div class="modal-header">
                                                                <h5 class="modal-title" id="return-order-modal">Return Order</h5>
                                                                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                                                                    <span aria-hidden="true">&times;</span>
                                                                </button>
                                                            </div>
                                                            <div class="modal-body" style="text-align: left;">
                                                                <p>You are currently return <strong>{{ order.listing.title }}</strong>
                                                                    Upon confirmation, a notification will be sent to <strong>{{ order.listing.user }}</strong>.
                                                                </p>
                                                                <p>
                                                                    Please expect up to 2 weeks for your return request to be processed. For more information,
                                                                    visit <a href="#">Return Policy</a>.
                                                                </p>


                                                            </div>
                                                            <div class="modal-footer">
                                                                <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                                <button type="submit" id="confirm-return-btn" class="btn confirm-return-btn">Confirm</button>
                                                            </div>
                                                        </div>
                                                        </div>
                                                    </div>
                                                </form>
                                            {% else %}
                                            {% endif %}
                                        </div>
                                    </div>
                                </div>
                                <hr>
                            {% endfor %}
                            <div class="row justify-content-center">
                                <nav aria-label="My purchases pagination">
                                    <ul class="pagination justify-content-center">
                                        {% if order_page_obj.has_previous %}
                                            <li class="page-item">
                                                <a class="page-link" style="color: #42f5c2;" href="?order-page=1">&laquo; first</a>
                                            </li>
                                            <li class="page-item">
                                                <a class="page-link" style="color: #42f5c2;" href="?order-page={{ orders.previous_page_number }}">previous</a>
                                            </li>
                                        {% endif %}

                                        {% if order_page_obj.number != 1%}
                                            <span class="current">
                                                <p style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">
                                                    Page {{ order_page_obj.number }} of {{ order_page_obj.paginator.num_pages }}.
                                                </p>
                                            </span>
                                        {% endif %}

                                        {% if order_page_obj.has_next %}
                                            <li class="page-item">
                                                <a class="page-link" style="color: #42f5c2;" href="?order-page={{ orders.next_page_number }}">next</a>
                                            </li>
                                            <li class="page-item">
                                                <a class="page-link" style="color: #42f5c2;" href="?order-page={{ orders.paginator.num_pages }}">last &raquo;</a>
                                            </li>
                                        {% endif %}
                                    </ul>
                                </nav>
                            </div>
                        {% else %}
                            <p>You have no purchases currently.</p>
                        {% endif %}
                    </div>

                    <div id="notif">
                        <h4>Notifications</h4>
                        <hr>
                        <!-- Notification Nav Bar -->
                        <ul class="nav nav-pills mb-3" id="pills-tab" role="tablist">
                            <li class="nav-item pill-1">
                                <a class="nav-link active" id="pills-pending-tab" data-toggle="pill" href="#pills-pending" role="tab" aria-controls="pills-pending" aria-selected="true">Pending Requests</a>
                            </li>
                            <li class="nav-item pill-1">
                                <a class="nav-link" id="pills-all-tab" data-toggle="pill" href="#pills-all" role="tab" aria-controls="pills-all" aria-selected="false">All Notifications</a>
                            </li>
                        </ul>

                        <div class="tab-content" id="myTabContent">
                            <div class="tab-pane fade show active" id="pills-pending" role="tabpanel" aria-labelledby="pills-pending-tab">
                                {% if has_actions %}
                                    {% for notification in notif_page_obj %}
                                        {% if notification.has_action %}
                                            <div class="row m-3 p-3">
                                                <div class="col-2">
                                                    <a href="{% url 'listing' notification.listing.id %}">
                                                        <img src="{% static notification.listing.listing_main_pic.url %}" alt="listing-image" style="max-width: 60px; max-height: 60px;">
                                                    </a>
                                                </div>
                                                {% if notification.has_action %}
                                                    <div class="col-10 indv-notif-content-section" style="vertical-align: middle;">
                                                        <p class="cart-item-details">{{ notification.content }}</p>
                                                        <p class="cart-item-details" style="font-style: italic; color: grey;">{{ notification.review.review }}</p>
                                                        <p class="cart-item-details notif-datetime" style="color: grey;">{{ notification.datetime }}</p>

                                                        <button type="button" name="accept-return-btn" data-toggle="modal" class="btn ml-2 accept-return-btn" data-target="#accept-return-modal">Accept</button>
                                                        <button type="button" name="cancel-return-btn" data-toggle="modal" class="btn btn-light" data-target="#cancel-return-modal">Cancel</button>
                                                        <form class="" action="{% url 'accept_return_order' %}" method="get">
                                                            {% csrf_token %}
                                                            <input type="text" style="display: none;" name="accept_return_order_id" value="{{ notification.order.id }}">

                                                            <!-- Accept Return Order Modal -->
                                                            <div class="modal fade" id="accept-return-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                                <div class="modal-dialog" role="document">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <h5 class="modal-title" id="accept-return-modal">Accept Return Request</h5>
                                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                                                                                <span aria-hidden="true">&times;</span>
                                                                            </button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                            <p>Are you sure you want to proceed with accepting the return request?</p>
                                                                            <p>Upon accepting, the quantity for <a href="{% url 'listing' notification.order.listing.id %}">{{ notification.order.listing.title }}</a>
                                                                               will automatically be updated.
                                                                            </p>
                                                                        </div>
                                                                        <div class="modal-footer">
                                                                        <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                                        <button type="submit" class="btn confirm-return-btn">Confirm</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>

                                                        <!-- Cancel Return Modal -->
                                                        <div class="modal fade" id="cancel-return-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                            <form class="" action="{% url 'cancel_return_order' %}" method="POST">
                                                                {% csrf_token %}
                                                                <input type="text" style="display: none;" name="cancel_return_order_id" value="{{ notification.order.id }}">
                                                                <div class="modal-dialog" role="document">
                                                                    <div class="modal-content">
                                                                        <div class="modal-header">
                                                                            <h5 class="modal-title" id="cancel-return-modal">Cancel Return Request</h5>
                                                                            <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                                                                                <span aria-hidden="true">&times;</span>
                                                                            </button>
                                                                        </div>
                                                                        <div class="modal-body">
                                                                            <label for="desrc">Reason for rejecting return request</label>
                                                                            <textarea class="form-control" rows="6" name="reason-rej-order-text" value=""></textarea>
                                                                        </div>
                                                                        <div class="modal-footer">
                                                                            <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                                            <button type="submit" class="btn confirm-return-btn">Confirm</button>
                                                                        </div>
                                                                    </div>
                                                                </div>
                                                            </form>
                                                        </div>
                                                    </div>
                                                {% else %}
                                                    <div class="col-10 indv-notif-content-section" style="vertical-align: middle;">
                                                        <p class="cart-item-details">{{ notification.content }}</p>
                                                        <p class="cart-item-details" style="font-style: italic; color: grey;">{{ notification.review.review }}</p>
                                                        <p class="cart-item-details notif-datetime" style="color: grey;">{{ notification.datetime }}</p>
                                                    </div>
                                                {% endif %}
                                            </div>
                                            <hr>
                                        {% endif %}
                                    {% endfor %}
                                {% else %}
                                    <p>You have no pending requests currently.</p>
                                {% endif %}
                            </div>

                            <div class="tab-pane fade" id="pills-all" role="tabpanel" aria-labelledby="pills-all-tab">
                                {% if has_notifications %}
                                    {% for notification in notif_page_obj %}
                                        <div class="row m-3 p-3">
                                            <div class="col-2">
                                                <a href="{% url 'listing' notification.listing.id %}">
                                                    <img src="{% static notification.listing.listing_main_pic.url %}" alt="listing-image" style="max-width: 60px; max-height: 60px;">
                                                </a>
                                            </div>
                                            {% if notification.has_action %}
                                                <div class="col-10 indv-notif-content-section" style="vertical-align: middle;">
                                                    <p class="cart-item-details">{{ notification.content }}</p>
                                                    <p class="cart-item-details" style="font-style: italic; color: grey;">{{ notification.review.review }}</p>
                                                    <p class="cart-item-details notif-datetime" style="color: grey;">{{ notification.datetime }}</p>

                                                    <button type="button" name="accept-return-btn" id="accept-return-btn" class="btn ml-2 accept-return-btn" data-toggle="modal" data-target="#accept-return-modal">Accept</button>
                                                    <button type="button" name="cancel-return-btn" id="cancel-return-btn" class="btn btn-light" data-toggle="modal" data-target="#cancel-return-modal">Cancel</button>
                                                    <form class="" action="{% url 'accept_return_order' %}" method="get">
                                                        {% csrf_token %}
                                                        <input type="text" style="display: none;" name="accept_return_order_id" value="{{ notification.order.id }}">


                                                        <!-- Accept Return Order Modal -->
                                                        <div class="modal fade" id="accept-return-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                            <div class="modal-dialog" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header">
                                                                        <h5 class="modal-title" id="accept-return-modal">Accept Return Request</h5>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                    <div class="modal-body">
                                                                        <p>Are you sure you want to proceed with accepting the return request?</p>
                                                                        <p>Upon accepting, the quantity for <a href="{% url 'listing' notification.order.listing.id %}">{{ notification.order.listing.title }}</a>
                                                                           will automatically be updated.
                                                                        </p>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                    <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                                    <button type="submit" class="btn confirm-return-btn">Confirm</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </div>
                                                    </form>

                                                    <!-- Cancel Return Modal -->
                                                    <div class="modal fade" id="cancel-return-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel" aria-hidden="true">
                                                        <form class="" action="{% url 'cancel_return_order' %}" method="POST">
                                                            {% csrf_token %}
                                                            <input type="text" style="display: none;" name="cancel_return_order_id" value="{{ notification.order.id }}">
                                                            <div class="modal-dialog" role="document">
                                                                <div class="modal-content">
                                                                    <div class="modal-header">
                                                                        <h5 class="modal-title" id="cancel-return-modal">Cancel Return Request</h5>
                                                                        <button type="button" class="close" data-dismiss="modal" aria-label="Cancel">
                                                                            <span aria-hidden="true">&times;</span>
                                                                        </button>
                                                                    </div>
                                                                    <div class="modal-body">
                                                                        <label for="desrc">Reason for rejecting return request</label>
                                                                        <textarea class="form-control" rows="6" name="reason-rej-order-text" value=""></textarea>
                                                                    </div>
                                                                    <div class="modal-footer">
                                                                        <button type="button" class="btn cancel-btn" data-dismiss="modal">Cancel</button>
                                                                        <button type="submit" class="btn confirm-return-btn">Confirm</button>
                                                                    </div>
                                                                </div>
                                                            </div>
                                                        </form>
                                                    </div>
                                                </div>
                                            {% else %}
                                                <div class="col-10 indv-notif-content-section" style="vertical-align: middle;">
                                                    <p class="cart-item-details">{{ notification.content }}</p>
                                                    <p class="cart-item-details" style="font-style: italic; color: grey;">{{ notification.review.review }}</p>
                                                    <p class="cart-item-details notif-datetime" style="color: grey;">{{ notification.datetime }}</p>
                                                </div>
                                            {% endif %}
                                        </div>
                                        <hr>
                                    {% endfor %}
                                    <div class="row justify-content-center">
                                        <nav aria-label="My Notification pagination">
                                            <ul class="pagination justify-content-center">
                                                {% if notif_page_obj.has_previous %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?notif-page=1">&laquo; first</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?notif-page={{ notif_page_obj.previous_page_number }}">previous</a>
                                                    </li>
                                                {% endif %}

                                                {% if notif_page_obj.number != 1 %}
                                                    <span class="current">
                                                        <p style="margin-top: 10px; margin-right: 10px; margin-left: 10px;">
                                                            Page {{ notif_page_obj.number }} of {{ notif_page_obj.paginator.num_pages }}.
                                                        </p>
                                                    </span>
                                                {% endif %}

                                                {% if notif_page_obj.has_next %}
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?notif-page={{ notif_page_obj.next_page_number }}">next</a>
                                                    </li>
                                                    <li class="page-item">
                                                        <a class="page-link" style="color: #42f5c2;" href="?notif-page={{ notif_page_obj.paginator.num_pages }}">last &raquo;</a>
                                                    </li>
                                                {% endif %}
                                            </ul>
                                        </nav>
                                    </div>
                                </div>
                            {% else %}
                                <p>You have no notifications currently.</p>
                            {% endif %}
                        </div>
                    </div>

                    <!-- Edit profile form -->
                    <div id="edit">
                        <h4>Edit Your Profile</h4>
                        <div class="container-fluid bg-light mt-4 mb-4">
                            <form id="edit-profile-form" class="" action="" method="post">
                                {% csrf_token %}
                                <div class="form-group row pt-3">
                                    <label for="id_username" class="col-sm-3 col-form-label">Username:</label>
                                    <div class="col-sm-9">
                                        <input type="text" readonly class="form-control-plaintext" id="id_username" value="{{ user.username }}">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="id_email" class="col-sm-3 col-form-label">Email:</label>
                                    <div class="col-sm-9">
                                        <input type="text" required class="form-control" id="id_email" value="">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="id_phone_number" class="col-sm-3 col-form-label">Phone Number:</label>
                                    <div class="col-sm-9">
                                        <input type="text" required class="form-control" id="id_phone_number" value="">
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="id_gender" class="col-sm-3 col-form-label">Gender:</label>
                                    <div class="col-sm-9">
                                        <select id="id_gender" class="form-control" name="gender" required>
                                            <option value="Male">Male</option>
                                            <option value="Female">Female</option>
                                            <option value="Other">Other</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="form-group row">
                                    <label for="id_date_of_birth" class="col-sm-3 col-form-label">Date of Birth:</label>
                                    <div class="col-sm-9">
                                        <input type="text" required class="form-control" id="id_date_of_birth" placeholder="YYYY-MM-DD" value="">
                                    </div>
                                </div>

                                <div class="" style="text-align: right;">
                                    <input id="undo-btn" data="{{ profile.id }}" class="btn" type="button" name="" value="Undo">
                                    <input id="save-btn" data="{{ profile.id }}" class="btn" type="submit" name="" value="Save">
                                </div>

                                <div class="row bg-light">
                                    <p style="color: transparent; font-size: 4px;">casc</p>
                                </div>
                            </form>
                        </div>
                    </div>
                </div>
            </div>
        </div>
{% endblock %}
